<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temperature and Humidity</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Firebase SDK (Modular) -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-database.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAAf3Vo3g_nJnHH2OEXc17_u6iCUQRMG74",
            authDomain: "esp32-humidity-cbbcb.firebaseapp.com",
            databaseURL: "https://esp32-humidity-cbbcb-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "esp32-humidity-cbbcb",
            storageBucket: "esp32-humidity-cbbcb.appspot.com",
            messagingSenderId: "925709082162",
            appId: "1:925709082162:web:3d0f4414bc0f081a73a62b",
            measurementId: "G-7GNR51NH9C"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // References to temperature and humidity in Firebase
        const tempRef = ref(database, "/humidifierhome/temp");
        const humRef = ref(database, "/humidifierhome/humidity");

        // Update temperature in the HTML
        onValue(tempRef, (snapshot) => {
            const temperature = snapshot.val();
            console.log("Temperature received:", temperature); // Debugging
            if (temperature !== null && !isNaN(temperature)) {
                document.getElementById("temperature").innerText = `${temperature.toFixed(1)}Â°C`;
            } else {
                document.getElementById("temperature").innerText = "No Data";
            }
        });

        // Update humidity in the HTML
        onValue(humRef, (snapshot) => {
            const humidity = snapshot.val();
            console.log("Humidity received:", humidity); // Debugging
            if (humidity !== null && !isNaN(humidity)) {
                document.getElementById("humidity").innerText = `${humidity.toFixed(1)}%`;
            } else {
                document.getElementById("humidity").innerText = "No Data";
            }
        });
    </script>
</head>

<body class="bg-slate-200">
    <!-- Header -->
    <header class="bg-white shadow-md">
        <div class="mx-auto flex h-16 max-w-screen-xl items-center justify-between px-4 sm:px-6 lg:px-8">
            <a class="block text-teal-600" href="#">
                <span class="sr-only">Home</span>
                <svg class="h-8 w-8" viewBox="0 0 28 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M0.41 10.3847C1.14777 7.4194..." fill="currentColor" />
                </svg>
            </a>
            <nav aria-label="Global">
                <ul class="flex items-center gap-6 text-sm">
                    <li>
                        <a class="text-gray-500 transition hover:text-gray-600" href="#">About</a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Section -->
    <div class="flex justify-center min-h-screen bg-gray-100">
        <div class="relative container bg-white max-w-3xl max-h-fit object-center mt-6 shadow-md rounded-lg">
            <div class="px-5 py-5 font-serif space-y-2">
                <p class="text-xl font-semibold">Temperature: <span id="temperature">Loading...</span></p>
                <p class="text-xl font-semibold">Humidity: <span id="humidity">Loading...</span></p>
                <p class="flex items-center gap-2">
                    <span>Humidifier control</span>
                    <label for="AcceptConditions" 
                        class="relative inline-block h-5 w-10 cursor-pointer rounded-full bg-gray-300 transition-all peer-checked:bg-green-500">
                        <input type="checkbox" id="AcceptConditions" class="peer sr-only" />
                        <span
                            class="absolute inset-y-0 left-0 m-1 h-3 w-3 rounded-full bg-white transition-all peer-checked:left-5"></span>
                    </label>
                </p>
            </div>
        </div>
    </div>
</body>

</html>
